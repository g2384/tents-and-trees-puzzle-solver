<html>
<header>
    <link rel="stylesheet" type="text/css" href="style.css" />
</header>
<meta charset="UTF-8">

<body style="font-family: 'Courier New', Courier, monospace">
    <div id="result"></div>
</body>
<script src="solver.js"></script>
<script>
    var resultDiv = document.getElementById("result");
    runTest();

    function runTest() {
        test1();
        test2();
        integrationTest1();
    }

    function test1() {
        var tentMap = [
            [0, 4, 2],
            [4, 3, 3],
            [1, 4, 3]
        ];
        var topHints = [2, 0, 1];
        var leftHints = [2, 0, 1];
        var expected = [
            [1, 4, 1],
            [4, 3, 3],
            [1, 4, 3],
        ]
        var rowCount = leftHints.length;
        var columnCount = topHints.length;
        resultDiv.innerHTML += "test PlaceExplicitTents()<br>";
        resultDiv.innerHTML += stringify(tentMap) + "<br>";
        PlaceExplicitTents(tentMap, topHints, leftHints, rowCount, columnCount);
        resultDiv.innerHTML += stringify(tentMap) + "<br>";
        equal(tentMap, expected);
    }

    function test2() {
        var tentMap = [
            [0, 0, 2],
            [4, 0, 4],
            [3, 4, 2]
        ];
        var topHints = [0, 1, 1];
        var leftHints = [0, 1, 1];
        var expected = [
            [3, 3, 3],
            [4, 0, 4],
            [3, 4, 2],
        ]
        var rowCount = leftHints.length;
        var columnCount = topHints.length;
        resultDiv.innerHTML += "test RemoveZeroColumnRow()<br>";
        resultDiv.innerHTML += stringify(tentMap) + "<br>";
        RemoveZeroColumnRow(tentMap, topHints, leftHints, rowCount, columnCount);
        resultDiv.innerHTML += stringify(tentMap) + "<br>";
        equal(tentMap, expected);
    }

    function integrationTest1() {
        var treeMap = [
            [false, false, false, false],
            [false, false, false, false],
            [false, true, true, false],
            [false, false, false, false]
        ];
        var topHints = [0, 1, 0, 1];
        var leftHints = [0, 0, 1, 1];
        var expected = "input:<br><div class='text-map'>____<br>____<br>_TT_<br>____<br></div>is valid: true<br><br>step 1: ignore zero columns and rows<br><div class='text-map'>□□□□<br>□□□□<br>□TT_<br>□_□_<br></div>is solved: false<br><br>step 2: exclude open land (no adjacent tree)<br><div class='text-map'>□□□□<br>□□□□<br>□TT_<br>□_□□<br></div>is solved: false<br><br>step 3: fill in tents<br><div class='text-map'>□□□□<br>□□□□<br>□TT▲<br>□▲□□<br></div>is solved: true<br><br>";
        var rowCount = leftHints.length;
        var columnCount = topHints.length;
        resultDiv.innerHTML += "test solve2()<br>";
        var actual = solve2(treeMap, topHints, leftHints, rowCount, columnCount);
        stringEqual(actual, expected);
    }

    function stringEqual(actual, expected) {
        if (actual != expected) {
            resultDiv.innerHTML += "actual: " + actual + "<br>";
            resultDiv.innerHTML += "expected: " + expected + "<br>";
            console.log(actual);
            console.log(expected);
        } else {
            resultDiv.innerHTML += "pass<br>";
        }
        resultDiv.innerHTML += "<br>";
    }

    function equal(actual, expected) {
        var areEqual = true;
        for (var row = 0; row < actual.length; row++) {
            for (var column = 0; column < actual[row].length; column++) {
                if (actual[row][column] != expected[row][column]) {
                    areEqual = false;
                    resultDiv.innerHTML += "mismatch at [" + row + ", " + column + "]<br>";
                }
            }
        }
        if (areEqual) {
            resultDiv.innerHTML += "pass<br>";
        }
        resultDiv.innerHTML += "<br>";
    }
</script>

</html>